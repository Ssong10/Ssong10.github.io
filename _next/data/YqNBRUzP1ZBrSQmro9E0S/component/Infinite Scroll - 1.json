{"pageProps":{"params":{"id":"Infinite Scroll - 1"},"code":{"css":".footer {\n  height : 50px;\n  line-height: 50px;\n  text-align:center;\n}\n\n#app li {\n  display:flex;\n  margin: 10px;\n  border:1px solid black;\n  height : 20vh;\n  text-align :center;\n  line-height: 20vh\n}\n.item-id {\n  border-right: 1px solid black;\n  width : 20%;\n}\n.item-data {\n  width : 80%;\n}\n\n.loading:after {\n  content: \"... 로딩중 ...\";\n}","description":"* Base Function\n\n  * getList \n\n    * 5개의 게시글을 비동기적으로 불러오게 되는 함수\n\n  * renderItem\n\n    * 하나의 게시글을 DOM 요소로 변경하는 함수\n\n  * fetchMore\n\n    * $footer 에 loading 을 해준후\n    * 비동기로 list를 불러옴\n    * documentFragment 를 이용하여 $app 요소까지 부착하게 되는 작업\n\n    * loading 표시를 제거해줌\n\n\n\n* Main Function\n\n  * 기본적으로 window에 scroll시에 onScroll 을 작동하게 합니다.\n  * clientHeight 는 element의 내부 높이입니다.\n    * 내부 여백(padding) 을 포함하고,  수평 스크롤바의 높이, 경계선 외부 여백(margin)을 포합하지 않습니다.\n  * scrollTop 은 element 최상단과 보여지는 컨텐츠와의 거리를 의미합니다.\n    * 세로 스크롤가 없다면 scrollTop 은 항상 0이 됩니다\n  * ScrollHeight 는 보이지 않는 부분까지 전체의 높이를 나타냅니다\n  * 결론적으로 스크롤이 제일 바닥으로 내려온 상태가 되면 clientHeight + scrollTop = ScrollHeight 임으로 게시글을 5개 더 불러오게 됩니다.\n\n* Issue\n\n  * scroll 이 발생할때 마다 onScroll이 동작하고 계산을 하게 됩니다.\n    * 이벤트의 발생 횟수를 줄이는 방법을 생각해봅니다\n    * [디바운스와 쓰로틀링](/component/throttle%20&%20debounce)\n\n  * 최적화된 Web API 인 Intersection Observer 를 사용하여 개선할 수 있습니다.\n\n    * 타겟 요소와 상위요소 또는 최상의 document의 사이의 intersection내의 변화를 관찰합니다\n\n    * [Infinite Scroll - 2(Intersection Observer) ](/component/Infinite Scroll - 2)\n\n","html":"<div id=\"app\"></div>\n<div class=\"footer\"></div>","js":"const $app = document.querySelector('#app')\nconst $footer = document.querySelector('.footer')\n\nconst getList = (count) => {\n  return new Promise(resolve => {\n    setTimeout(() => {\n      const data = Array.from({length:5}).map((_,idx)=>{\n        const id = (count*5)+idx+1\n        return {id, data: `${id}번째 게시글입니다`}\n      })\n      resolve(data)\n    },1000)\n  })\n}\n\nconst renderItem = ({id, data}) => {\n  const item = document.createElement('li')\n  item.innerHTML = `\n    <div class=\"item-id\">${id}</div>\n    <div class=\"item-data\">${data}</div>\n  `\n  return item\n}\nlet count = 0\nconst fetchMore = async () => {\n  $footer.classList.add(\"loading\");\n  const list = await getList(count ++)\n  const frag = document.createDocumentFragment()\n  list.forEach(item=> {\n    frag.appendChild(renderItem(item))\n  })\n  $app.appendChild(frag)\n  $footer.classList.remove(\"loading\");\n}\n\nconst onScroll = (e) => {\n  const {clientHeight,scrollTop,scrollHeight} = e.target.scrollingElement;\n  if (clientHeight + scrollTop === scrollHeight) {\n    fetchMore()\n  }\n}\n\nfetchMore()\nwindow.addEventListener('scroll',onScroll)"}},"__N_SSG":true}